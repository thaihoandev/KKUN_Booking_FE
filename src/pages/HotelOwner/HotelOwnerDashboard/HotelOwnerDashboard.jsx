import React from "react";
import "swiper/css"; // Import CSS cho Swiper
import "swiper/css/navigation"; // Import CSS cho Navigation
import "bootstrap-icons/font/bootstrap-icons.css";
import { useState, useEffect } from "react";
import Loading from "../../../components/Loading/Loading";
import { useSelector } from "react-redux";
import { useMutation } from "react-query";
import * as HotelService from "../../../services/HotelService";
import * as UserService from "../../../services/UserService";
import * as BookingService from "../../../services/BookingService";

import { toast } from "react-toastify";
import { useNavigate } from "react-router-dom";
import convertToVND from "../../../utils/convertToVND";
import moment from "moment";
function HotelOwnerDashBoard() {
    const user = useSelector((state) => state.user);
    const [hotels, setHotels] = useState([]);
    const [users, setUsers] = useState([]);
    const [bookings, setBookings] = useState([]);
    const itemsPerPage = 12;
    const [currentPage, setCurrentPage] = useState(1);
    const currentYear = new Date().getFullYear(); // Current year
    const [filteredBookings, setFilteredBookings] = useState([]);

    const [selectedMonth, setSelectedMonth] = useState(new Date().getMonth()); // Default to current month
    const [selectedYear, setSelectedYear] = useState(new Date().getFullYear()); // Default to current year
    const totalPages = Math.ceil(
        (filteredBookings?.length || 0) / itemsPerPage
    );
    const indexOfLastItem = currentPage * itemsPerPage;
    const indexOfFirstItem = indexOfLastItem - itemsPerPage;
    const currentItems =
        filteredBookings?.slice(indexOfFirstItem, indexOfLastItem) || [];
    const navigate = useNavigate();
    const years = Array.from({ length: 6 }, (_, i) => currentYear - 5 + i);
    // Generate page numbers
    const pageNumbers = [];

    const mutationBooking = useMutation(
        ({ accessToken }) => {
            return HotelService.getHotelBookingHistory(accessToken);
        },
        {
            onSuccess: (data) => {
                setBookings(data);
            },
            onError: (error) => {
                toast.error(error.message);
            },
        }
    );
    const totalRevenue = filteredBookings.reduce(
        (acc, booking) => acc + booking.totalPrice,
        0
    );
    const totalProfit = filteredBookings.reduce((acc, booking) => {
        // Convert values to numbers (if they're strings) and handle potential NaN values
        const totalPrice = parseFloat(booking.totalPrice);
        const taxRate = parseFloat(booking.taxRate || 0); // Default to 0 if not available
        const serviceFeeRate = parseFloat(booking.serviceFeeRate || 0); // Default to 0 if not available
        const discount = parseFloat(booking.discount || 0); // Default to 0 if not available

        // Calculate the total after deductions
        const profit = totalPrice - (taxRate + serviceFeeRate + discount);

        // Add the profit to the accumulator
        return acc + (isNaN(profit) ? 0 : profit);
    }, 0);

    for (let i = 1; i <= totalPages; i++) {
        pageNumbers.push(i);
    }

    const handlePageClick = (pageNumber) => {
        setCurrentPage(pageNumber);
    };

    const handlePrevClick = () => {
        if (currentPage > 1) {
            setCurrentPage(currentPage - 1);
        }
    };

    const handleNextClick = () => {
        if (currentPage < totalPages) {
            setCurrentPage(currentPage + 1);
        }
    };

    const filterBookingsByMonth = () => {
        if (bookings && bookings.length > 0) {
            const filtered = bookings.filter((booking) => {
                const bookingDate = new Date(booking.createdDate);

                const bookingMonth = bookingDate.getMonth();
                const bookingYear = bookingDate.getFullYear();

                return (
                    bookingMonth === selectedMonth &&
                    bookingYear === selectedYear
                );
            });
            setFilteredBookings(filtered);
        }
    };

    // Call the filter function whenever the selected month or year changes
    useEffect(() => {
        filterBookingsByMonth();
    }, [selectedMonth, selectedYear, bookings]);
    useEffect(() => {
        mutationBooking.mutate({ accessToken: user.accessToken });
    }, [user.accessToken]);
    return (
        <>
            {/* ======================================== */}
            <div class="row">
                <div class="col-xl-12">
                    <div class="main-content-title-profile mb-10">
                        <div class="main-content-title">
                            <h3>Hi, {user.lastName}! </h3>
                        </div>
                        <div class="profile">
                            <a href="#">
                                View Profile
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="8"
                                    height="8"
                                    viewBox="0 0 8 8"
                                >
                                    <path d="M6.669 2.27202L0.94102 8L0 7.05898L5.72731 1.331H0.679478V0H8V7.32052H6.669V2.27202Z" />
                                </svg>
                            </a>
                        </div>
                    </div>
                    <div className="filter mb-3">
                        <div className="d-flex align-items-center ">
                            <label className="form-label me-2">
                                Chọn tháng:
                            </label>
                            <select
                                className="form-select w-auto"
                                value={selectedMonth}
                                onChange={(e) =>
                                    setSelectedMonth(Number(e.target.value))
                                }
                            >
                                {Array.from({ length: 12 }, (_, i) => (
                                    <option key={i} value={i}>
                                        Tháng {i + 1}
                                    </option>
                                ))}
                            </select>

                            <label className="form-label mx-2">Chọn năm:</label>
                            <select
                                className="form-select w-auto"
                                value={selectedYear}
                                onChange={(e) =>
                                    setSelectedYear(Number(e.target.value))
                                }
                                style={{
                                    maxHeight: "200px",
                                    overflowY: "auto",
                                }} // Scrollable dropdown
                            >
                                {/* Render years in descending order */}
                                {years.reverse().map((year) => (
                                    <option key={year} value={year}>
                                        {year}
                                    </option>
                                ))}
                            </select>
                        </div>
                    </div>
                    <div class="counter-area">
                        <div class="row g-3">
                            <div class="col">
                                <div class="counter-single two">
                                    <div class="counter-icon">
                                        <svg
                                            xmlns="http://www.w3.org/2000/svg"
                                            width="55"
                                            height="55"
                                            viewBox="0 0 23 23"
                                        >
                                            <g>
                                                <path d="M19.5496 12.2665H16.0038C15.9021 12.2665 15.8046 12.3069 15.7327 12.3788C15.6608 12.4506 15.6204 12.5481 15.6204 12.6498V22.2333H13.6079V18.2562C13.6079 18.1545 13.5675 18.057 13.4956 17.9851C13.4237 17.9132 13.3262 17.8728 13.2245 17.8728H9.77448C9.67281 17.8728 9.57531 17.9132 9.50342 17.9851C9.43153 18.057 9.39114 18.1545 9.39114 18.2562V22.2333H7.37861V8.33724C7.37861 7.91452 7.72256 7.57056 8.14529 7.57056H14.8537C15.2765 7.57056 15.6204 7.91452 15.6204 8.33724V10.4696C15.6204 10.5712 15.6608 10.6687 15.7327 10.7406C15.8046 10.8125 15.9021 10.8529 16.0038 10.8529C16.1054 10.8529 16.2029 10.8125 16.2748 10.7406C16.3467 10.6687 16.3871 10.5712 16.3871 10.4696V8.33724C16.3871 7.49174 15.6992 6.80389 14.8537 6.80389H8.14529C7.29978 6.80389 6.61193 7.49174 6.61193 8.33724V22.2333H3.44937C3.02665 22.2333 2.6827 21.8894 2.6827 21.4666V13.7998C2.6827 13.3771 3.02665 13.0332 3.44937 13.0332H4.79106C4.89273 13.0332 4.99024 12.9928 5.06213 12.9209C5.13402 12.849 5.1744 12.7515 5.1744 12.6498C5.1744 12.5481 5.13402 12.4506 5.06213 12.3788C4.99024 12.3069 4.89273 12.2665 4.79106 12.2665H3.44937C2.60387 12.2665 1.91602 12.9543 1.91602 13.7998V21.4666C1.91602 22.3121 2.60387 23 3.44937 23H16.0038C16.1054 23 16.2029 22.9596 16.2748 22.8877C16.3467 22.8158 16.3871 22.7183 16.3871 22.6166V13.0332H19.5496C19.9724 13.0332 20.3163 13.3771 20.3163 13.7998V21.4666C20.3163 21.8894 19.9724 22.2333 19.5496 22.2333H17.9205C17.8188 22.2333 17.7213 22.2737 17.6494 22.3456C17.5775 22.4175 17.5371 22.515 17.5371 22.6166C17.5371 22.7183 17.5775 22.8158 17.6494 22.8877C17.7213 22.9596 17.8188 23 17.9205 23H19.5496C20.3951 23 21.083 22.3121 21.083 21.4666V13.7998C21.083 12.9543 20.3951 12.2665 19.5496 12.2665ZM10.1578 18.6395H12.8412V22.2333H10.1578V18.6395ZM9.91047 3.38493L9.66638 4.81306C9.61295 5.12577 9.94233 5.36473 10.2231 5.21667L11.4995 4.54323L12.7759 5.21667C13.0564 5.36473 13.3861 5.12591 13.3326 4.81306L13.0885 3.38493L14.1222 2.37377C14.3485 2.15239 14.2231 1.76613 13.9095 1.72042L12.4821 1.51226L11.8435 0.213796C11.7034 -0.0712652 11.2957 -0.0712652 11.1556 0.213796L10.517 1.51226L9.0896 1.72042C8.77631 1.76603 8.65029 2.15215 8.87684 2.37377L9.91047 3.38493ZM10.8272 2.24181C10.8888 2.23283 10.9472 2.209 10.9975 2.17239C11.0478 2.13577 11.0884 2.08747 11.1159 2.03164L11.4995 1.25159L11.8831 2.03164C11.9106 2.08746 11.9512 2.13577 12.0015 2.17238C12.0518 2.209 12.1102 2.23283 12.1718 2.24181L13.0324 2.36735L12.4087 2.97739C12.3644 3.02074 12.3313 3.07419 12.3122 3.13316C12.293 3.19213 12.2885 3.25486 12.2989 3.31597L12.4458 4.17571C11.6045 3.73185 11.6245 3.72648 11.4995 3.72648C11.3729 3.72648 11.3843 3.73717 10.5531 4.17571L10.7 3.31597C10.7105 3.25486 10.7059 3.19213 10.6868 3.13316C10.6677 3.07418 10.6345 3.02073 10.5902 2.97739L9.96653 2.36735L10.8272 2.24181ZM5.66953 3.49173C5.75655 3.22397 6.00088 3.22766 6.24406 3.1923C6.35365 2.9702 6.42462 2.73842 6.70633 2.73842C6.98784 2.73842 7.05986 2.97193 7.16863 3.1923L7.43371 3.23082C7.74748 3.27644 7.87335 3.66323 7.64618 3.8847L7.45436 4.07168C7.4962 4.31577 7.57507 4.54506 7.34713 4.71061C7.11937 4.87612 6.92387 4.72949 6.70633 4.61511C6.48715 4.73035 6.29347 4.87621 6.06552 4.71061C5.83772 4.54515 5.91674 4.3139 5.95829 4.07168C5.78113 3.89889 5.58247 3.75964 5.66953 3.49173ZM2.31531 5.40843C2.40233 5.14067 2.64666 5.14436 2.88984 5.109L3.00839 4.86879C3.14874 4.58449 3.55546 4.58425 3.69591 4.86879L3.81446 5.109C4.05951 5.1446 4.30192 5.14048 4.38899 5.40843C4.47601 5.6762 4.27614 5.81683 4.10019 5.98838L4.14547 6.2524C4.18577 6.48729 4.00426 6.70053 3.76759 6.70053C3.64943 6.70053 3.60271 6.66358 3.3522 6.53181L3.11515 6.65649C2.8345 6.80398 2.5053 6.56516 2.55892 6.2524L2.60421 5.98838C2.42691 5.81559 2.22825 5.67634 2.31531 5.40843ZM15.2559 3.49173C15.3429 3.22397 15.5872 3.22766 15.8304 3.1923L15.9489 2.95209C16.0893 2.66775 16.496 2.6676 16.6365 2.95209L16.755 3.1923C17 3.2279 17.2425 3.22378 17.3295 3.49173C17.4165 3.7595 17.2167 3.90013 17.0407 4.07168L17.086 4.3357C17.1263 4.5706 16.9448 4.78383 16.7081 4.78383C16.59 4.78383 16.5433 4.74688 16.2927 4.61511L16.0557 4.73979C15.775 4.88728 15.4458 4.64846 15.4995 4.3357L15.5447 4.07168C15.3674 3.89889 15.1688 3.75964 15.2559 3.49173ZM18.6101 5.40843C18.6971 5.14067 18.9414 5.14436 19.1846 5.109L19.3032 4.86879C19.4435 4.58444 19.8502 4.5843 19.9907 4.86879L20.1092 5.109C20.3542 5.1446 20.5967 5.14048 20.6838 5.40843C20.7708 5.6762 20.5709 5.81683 20.395 5.98838L20.4402 6.2524C20.4805 6.48729 20.299 6.70053 20.0624 6.70053C19.9442 6.70053 19.8975 6.66358 19.647 6.53181L19.4099 6.65649C19.1293 6.80398 18.8001 6.56516 18.8537 6.2524L18.899 5.98838C18.7216 5.81559 18.523 5.67634 18.6101 5.40843ZM4.64731 15.7165C4.74898 15.7165 4.84648 15.7569 4.91837 15.8288C4.99026 15.9007 5.03065 15.9982 5.03065 16.0999V17.7291C5.03065 17.8307 4.99026 17.9282 4.91837 18.0001C4.84648 18.072 4.74898 18.1124 4.64731 18.1124C4.54564 18.1124 4.44814 18.072 4.37625 18.0001C4.30436 17.9282 4.26397 17.8307 4.26397 17.7291V16.0999C4.26397 15.9982 4.30436 15.9007 4.37625 15.8288C4.44814 15.7569 4.54564 15.7165 4.64731 15.7165ZM18.3517 18.1124C18.25 18.1124 18.1525 18.072 18.0806 18.0001C18.0088 17.9282 17.9684 17.8307 17.9684 17.7291V16.0999C17.9684 15.9982 18.0088 15.9007 18.0806 15.8288C18.1525 15.7569 18.25 15.7165 18.3517 15.7165C18.4534 15.7165 18.5509 15.7569 18.6228 15.8288C18.6947 15.9007 18.735 15.9982 18.735 16.0999V17.7291C18.735 17.8307 18.6947 17.9282 18.6228 18.0001C18.5509 18.072 18.4534 18.1124 18.3517 18.1124ZM13.7037 11.4519H9.29531C9.19364 11.4519 9.09613 11.4115 9.02424 11.3396C8.95235 11.2677 8.91197 11.1702 8.91197 11.0685C8.91197 10.9669 8.95235 10.8694 9.02424 10.7975C9.09613 10.7256 9.19364 10.6852 9.29531 10.6852H13.7037C13.8054 10.6852 13.9029 10.7256 13.9748 10.7975C14.0467 10.8694 14.0871 10.9669 14.0871 11.0685C14.0871 11.1702 14.0467 11.2677 13.9748 11.3396C13.9029 11.4115 13.8054 11.4519 13.7037 11.4519ZM13.0329 14.3748C13.1345 14.3748 13.232 14.4152 13.3039 14.4871C13.3758 14.559 13.4162 14.6565 13.4162 14.7582C13.4162 14.8599 13.3758 14.9574 13.3039 15.0292C13.232 15.1011 13.1345 15.1415 13.0329 15.1415H9.96615C9.86448 15.1415 9.76698 15.1011 9.69509 15.0292C9.6232 14.9574 9.58281 14.8599 9.58281 14.7582C9.58281 14.6565 9.6232 14.559 9.69509 14.4871C9.76698 14.4152 9.86448 14.3748 9.96615 14.3748H13.0329Z"></path>
                                            </g>
                                        </svg>
                                    </div>
                                    <div class="counter-content">
                                        <p>Total Revenue</p>
                                        <div class="number">
                                            <h3 class="counter">
                                                {convertToVND(totalRevenue)} /{" "}
                                                {filteredBookings.length} đơn
                                            </h3>
                                            <span></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="counter-single three">
                                    <div class="counter-icon">
                                        <svg
                                            xmlns="http://www.w3.org/2000/svg"
                                            width="55"
                                            height="55"
                                            viewBox="0 0 23 23"
                                        >
                                            <g>
                                                <path d="M19.5496 12.2665H16.0038C15.9021 12.2665 15.8046 12.3069 15.7327 12.3788C15.6608 12.4506 15.6204 12.5481 15.6204 12.6498V22.2333H13.6079V18.2562C13.6079 18.1545 13.5675 18.057 13.4956 17.9851C13.4237 17.9132 13.3262 17.8728 13.2245 17.8728H9.77448C9.67281 17.8728 9.57531 17.9132 9.50342 17.9851C9.43153 18.057 9.39114 18.1545 9.39114 18.2562V22.2333H7.37861V8.33724C7.37861 7.91452 7.72256 7.57056 8.14529 7.57056H14.8537C15.2765 7.57056 15.6204 7.91452 15.6204 8.33724V10.4696C15.6204 10.5712 15.6608 10.6687 15.7327 10.7406C15.8046 10.8125 15.9021 10.8529 16.0038 10.8529C16.1054 10.8529 16.2029 10.8125 16.2748 10.7406C16.3467 10.6687 16.3871 10.5712 16.3871 10.4696V8.33724C16.3871 7.49174 15.6992 6.80389 14.8537 6.80389H8.14529C7.29978 6.80389 6.61193 7.49174 6.61193 8.33724V22.2333H3.44937C3.02665 22.2333 2.6827 21.8894 2.6827 21.4666V13.7998C2.6827 13.3771 3.02665 13.0332 3.44937 13.0332H4.79106C4.89273 13.0332 4.99024 12.9928 5.06213 12.9209C5.13402 12.849 5.1744 12.7515 5.1744 12.6498C5.1744 12.5481 5.13402 12.4506 5.06213 12.3788C4.99024 12.3069 4.89273 12.2665 4.79106 12.2665H3.44937C2.60387 12.2665 1.91602 12.9543 1.91602 13.7998V21.4666C1.91602 22.3121 2.60387 23 3.44937 23H16.0038C16.1054 23 16.2029 22.9596 16.2748 22.8877C16.3467 22.8158 16.3871 22.7183 16.3871 22.6166V13.0332H19.5496C19.9724 13.0332 20.3163 13.3771 20.3163 13.7998V21.4666C20.3163 21.8894 19.9724 22.2333 19.5496 22.2333H17.9205C17.8188 22.2333 17.7213 22.2737 17.6494 22.3456C17.5775 22.4175 17.5371 22.515 17.5371 22.6166C17.5371 22.7183 17.5775 22.8158 17.6494 22.8877C17.7213 22.9596 17.8188 23 17.9205 23H19.5496C20.3951 23 21.083 22.3121 21.083 21.4666V13.7998C21.083 12.9543 20.3951 12.2665 19.5496 12.2665ZM10.1578 18.6395H12.8412V22.2333H10.1578V18.6395ZM9.91047 3.38493L9.66638 4.81306C9.61295 5.12577 9.94233 5.36473 10.2231 5.21667L11.4995 4.54323L12.7759 5.21667C13.0564 5.36473 13.3861 5.12591 13.3326 4.81306L13.0885 3.38493L14.1222 2.37377C14.3485 2.15239 14.2231 1.76613 13.9095 1.72042L12.4821 1.51226L11.8435 0.213796C11.7034 -0.0712652 11.2957 -0.0712652 11.1556 0.213796L10.517 1.51226L9.0896 1.72042C8.77631 1.76603 8.65029 2.15215 8.87684 2.37377L9.91047 3.38493ZM10.8272 2.24181C10.8888 2.23283 10.9472 2.209 10.9975 2.17239C11.0478 2.13577 11.0884 2.08747 11.1159 2.03164L11.4995 1.25159L11.8831 2.03164C11.9106 2.08746 11.9512 2.13577 12.0015 2.17238C12.0518 2.209 12.1102 2.23283 12.1718 2.24181L13.0324 2.36735L12.4087 2.97739C12.3644 3.02074 12.3313 3.07419 12.3122 3.13316C12.293 3.19213 12.2885 3.25486 12.2989 3.31597L12.4458 4.17571C11.6045 3.73185 11.6245 3.72648 11.4995 3.72648C11.3729 3.72648 11.3843 3.73717 10.5531 4.17571L10.7 3.31597C10.7105 3.25486 10.7059 3.19213 10.6868 3.13316C10.6677 3.07418 10.6345 3.02073 10.5902 2.97739L9.96653 2.36735L10.8272 2.24181ZM5.66953 3.49173C5.75655 3.22397 6.00088 3.22766 6.24406 3.1923C6.35365 2.9702 6.42462 2.73842 6.70633 2.73842C6.98784 2.73842 7.05986 2.97193 7.16863 3.1923L7.43371 3.23082C7.74748 3.27644 7.87335 3.66323 7.64618 3.8847L7.45436 4.07168C7.4962 4.31577 7.57507 4.54506 7.34713 4.71061C7.11937 4.87612 6.92387 4.72949 6.70633 4.61511C6.48715 4.73035 6.29347 4.87621 6.06552 4.71061C5.83772 4.54515 5.91674 4.3139 5.95829 4.07168C5.78113 3.89889 5.58247 3.75964 5.66953 3.49173ZM2.31531 5.40843C2.40233 5.14067 2.64666 5.14436 2.88984 5.109L3.00839 4.86879C3.14874 4.58449 3.55546 4.58425 3.69591 4.86879L3.81446 5.109C4.05951 5.1446 4.30192 5.14048 4.38899 5.40843C4.47601 5.6762 4.27614 5.81683 4.10019 5.98838L4.14547 6.2524C4.18577 6.48729 4.00426 6.70053 3.76759 6.70053C3.64943 6.70053 3.60271 6.66358 3.3522 6.53181L3.11515 6.65649C2.8345 6.80398 2.5053 6.56516 2.55892 6.2524L2.60421 5.98838C2.42691 5.81559 2.22825 5.67634 2.31531 5.40843ZM15.2559 3.49173C15.3429 3.22397 15.5872 3.22766 15.8304 3.1923L15.9489 2.95209C16.0893 2.66775 16.496 2.6676 16.6365 2.95209L16.755 3.1923C17 3.2279 17.2425 3.22378 17.3295 3.49173C17.4165 3.7595 17.2167 3.90013 17.0407 4.07168L17.086 4.3357C17.1263 4.5706 16.9448 4.78383 16.7081 4.78383C16.59 4.78383 16.5433 4.74688 16.2927 4.61511L16.0557 4.73979C15.775 4.88728 15.4458 4.64846 15.4995 4.3357L15.5447 4.07168C15.3674 3.89889 15.1688 3.75964 15.2559 3.49173ZM18.6101 5.40843C18.6971 5.14067 18.9414 5.14436 19.1846 5.109L19.3032 4.86879C19.4435 4.58444 19.8502 4.5843 19.9907 4.86879L20.1092 5.109C20.3542 5.1446 20.5967 5.14048 20.6838 5.40843C20.7708 5.6762 20.5709 5.81683 20.395 5.98838L20.4402 6.2524C20.4805 6.48729 20.299 6.70053 20.0624 6.70053C19.9442 6.70053 19.8975 6.66358 19.647 6.53181L19.4099 6.65649C19.1293 6.80398 18.8001 6.56516 18.8537 6.2524L18.899 5.98838C18.7216 5.81559 18.523 5.67634 18.6101 5.40843ZM4.64731 15.7165C4.74898 15.7165 4.84648 15.7569 4.91837 15.8288C4.99026 15.9007 5.03065 15.9982 5.03065 16.0999V17.7291C5.03065 17.8307 4.99026 17.9282 4.91837 18.0001C4.84648 18.072 4.74898 18.1124 4.64731 18.1124C4.54564 18.1124 4.44814 18.072 4.37625 18.0001C4.30436 17.9282 4.26397 17.8307 4.26397 17.7291V16.0999C4.26397 15.9982 4.30436 15.9007 4.37625 15.8288C4.44814 15.7569 4.54564 15.7165 4.64731 15.7165ZM18.3517 18.1124C18.25 18.1124 18.1525 18.072 18.0806 18.0001C18.0088 17.9282 17.9684 17.8307 17.9684 17.7291V16.0999C17.9684 15.9982 18.0088 15.9007 18.0806 15.8288C18.1525 15.7569 18.25 15.7165 18.3517 15.7165C18.4534 15.7165 18.5509 15.7569 18.6228 15.8288C18.6947 15.9007 18.735 15.9982 18.735 16.0999V17.7291C18.735 17.8307 18.6947 17.9282 18.6228 18.0001C18.5509 18.072 18.4534 18.1124 18.3517 18.1124ZM13.7037 11.4519H9.29531C9.19364 11.4519 9.09613 11.4115 9.02424 11.3396C8.95235 11.2677 8.91197 11.1702 8.91197 11.0685C8.91197 10.9669 8.95235 10.8694 9.02424 10.7975C9.09613 10.7256 9.19364 10.6852 9.29531 10.6852H13.7037C13.8054 10.6852 13.9029 10.7256 13.9748 10.7975C14.0467 10.8694 14.0871 10.9669 14.0871 11.0685C14.0871 11.1702 14.0467 11.2677 13.9748 11.3396C13.9029 11.4115 13.8054 11.4519 13.7037 11.4519ZM13.0329 14.3748C13.1345 14.3748 13.232 14.4152 13.3039 14.4871C13.3758 14.559 13.4162 14.6565 13.4162 14.7582C13.4162 14.8599 13.3758 14.9574 13.3039 15.0292C13.232 15.1011 13.1345 15.1415 13.0329 15.1415H9.96615C9.86448 15.1415 9.76698 15.1011 9.69509 15.0292C9.6232 14.9574 9.58281 14.8599 9.58281 14.7582C9.58281 14.6565 9.6232 14.559 9.69509 14.4871C9.76698 14.4152 9.86448 14.3748 9.96615 14.3748H13.0329Z"></path>
                                            </g>
                                        </svg>
                                    </div>
                                    <div class="counter-content">
                                        <p>Total Profit</p>
                                        <div class="number">
                                            <h3 class="counter">
                                                {convertToVND(totalProfit)}
                                            </h3>
                                            <span></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="counter-single four ">
                                    <div class="counter-icon">
                                        <svg
                                            xmlns="http://www.w3.org/2000/svg"
                                            width="50"
                                            height="55"
                                            viewBox="0 0 23 23"
                                        >
                                            <path d="M16.7611 10.0896L15.946 9.90118L15.7703 9.02653C15.7562 8.95659 15.7249 8.89201 15.6795 8.83957C15.6341 8.78713 15.5764 8.74879 15.5125 8.72857C15.4485 8.70835 15.3806 8.707 15.316 8.72467C15.2514 8.74233 15.1924 8.77836 15.1453 8.82896L13.6465 10.4371C13.6026 10.4842 13.5705 10.5423 13.553 10.6061C13.5354 10.6699 13.5331 10.7374 13.5462 10.8025L13.7297 11.7162L13.1228 12.3674C12.6046 11.9319 11.953 11.6713 11.2453 11.6713C9.56304 11.6713 8.1944 13.1398 8.1944 14.9449C8.1944 16.7499 9.56304 18.2184 11.2453 18.2184C12.9276 18.2184 14.2962 16.7499 14.2962 14.9449C14.2962 14.1855 14.0533 13.4864 13.6475 12.9304L14.2544 12.2792L15.1059 12.4761C15.1666 12.4902 15.2295 12.4877 15.289 12.4689C15.3485 12.4501 15.4026 12.4156 15.4464 12.3685L16.9453 10.7603C16.9924 10.7097 17.0259 10.6464 17.0424 10.5771C17.0588 10.5078 17.0575 10.435 17.0387 10.3663C17.0198 10.2977 16.9841 10.2358 16.9353 10.1871C16.8864 10.1384 16.8262 10.1048 16.7611 10.0896ZM13.5543 14.9448C13.5543 16.3109 12.5185 17.4223 11.2453 17.4223C9.97217 17.4223 8.93633 16.3109 8.93633 14.9448C8.93633 13.5788 9.97217 12.4673 11.2453 12.4673C11.7483 12.4673 12.2138 12.6413 12.5935 12.9354L11.8476 13.7356C11.8255 13.6807 11.792 13.6318 11.7498 13.5927C11.7075 13.5536 11.6576 13.5252 11.6037 13.5097C11.5087 13.4825 11.4074 13.4968 11.3222 13.5496C11.237 13.6024 11.1749 13.6893 11.1493 13.7912L10.887 14.8418C10.8702 14.9093 10.8702 14.9803 10.887 15.0478C10.9039 15.1153 10.937 15.1768 10.9831 15.2262C11.0291 15.2756 11.0864 15.3111 11.1493 15.3292C11.2122 15.3473 11.2784 15.3474 11.3413 15.3293L12.3204 15.0479C12.3675 15.0343 12.4116 15.011 12.4502 14.9792C12.4889 14.9474 12.5213 14.9077 12.5457 14.8624C12.57 14.8171 12.5858 14.7672 12.5922 14.7154C12.5985 14.6635 12.5953 14.6109 12.5827 14.5604C12.5683 14.5025 12.5419 14.449 12.5054 14.4036C12.469 14.3583 12.4234 14.3224 12.3722 14.2986L13.1181 13.4984C13.3922 13.9057 13.5543 14.4052 13.5543 14.9448ZM15.0647 11.6522L14.4472 11.5094L14.314 10.8468L15.1884 9.90854L15.2711 10.3201C15.2862 10.3949 15.321 10.4635 15.3714 10.5177C15.4219 10.5718 15.4858 10.6092 15.5556 10.6253L15.9391 10.714L15.0647 11.6522ZM16.468 13.979C16.5188 14.298 16.5444 14.6211 16.5445 14.9448C16.5445 18.0801 14.1673 20.6307 11.2453 20.6307C8.32331 20.6307 5.94615 18.08 5.94615 14.9448C5.94615 11.8096 8.32336 9.25894 11.2453 9.25894C11.546 9.25894 11.8488 9.28655 12.1454 9.34098C12.2424 9.35882 12.3288 9.41724 12.3856 9.5034C12.4425 9.58956 12.4651 9.69642 12.4485 9.80047C12.4319 9.90452 12.3775 9.99722 12.2971 10.0582C12.2168 10.1192 12.1173 10.1435 12.0203 10.1257C11.7643 10.0787 11.505 10.055 11.2453 10.055C8.73244 10.055 6.68808 12.2486 6.68808 14.9448C6.68808 17.641 8.73244 19.8346 11.2453 19.8346C13.7582 19.8346 15.8026 17.641 15.8026 14.9448C15.8025 14.6661 15.7804 14.388 15.7367 14.1133C15.7201 14.0093 15.7427 13.9024 15.7995 13.8163C15.8563 13.7301 15.9427 13.6717 16.0397 13.6538C16.0877 13.645 16.1369 13.6464 16.1844 13.658C16.2319 13.6695 16.2768 13.691 16.3166 13.7212C16.3564 13.7514 16.3902 13.7897 16.4162 13.8339C16.4421 13.8782 16.4597 13.9275 16.468 13.979ZM20.834 2.12563H20.249V0.879517C20.249 0.394556 19.8813 0 19.4293 0H18.5395C18.0875 0 17.7197 0.394556 17.7197 0.879517V2.12563H16.5068V0.879517C16.5068 0.394556 16.139 0 15.6871 0H14.7973C14.3453 0 13.9776 0.394556 13.9776 0.879517V2.12563H12.7646V0.879517C12.7646 0.394556 12.3969 0 11.9449 0H11.0551C10.6031 0 10.2354 0.394556 10.2354 0.879517V2.12563H9.0224V0.879517C9.0224 0.394556 8.65463 0 8.20265 0H7.31284C6.86086 0 6.49314 0.394556 6.49314 0.879517V2.12563H5.28017V0.879517C5.28017 0.394556 4.91245 0 4.46047 0H3.5707C3.11873 0 2.75096 0.394556 2.75096 0.879517V2.12563H2.16599C0.971657 2.12563 0 3.16814 0 4.44963V20.676C0 21.9575 0.971657 23 2.16599 23H18.116C18.7113 23 19.2266 22.771 19.6476 22.3194L22.3656 19.403C22.7866 18.9513 23 18.3984 23 17.7597V4.44963C23 3.16814 22.0283 2.12563 20.834 2.12563ZM18.4617 0.879517C18.462 0.857472 18.4702 0.836413 18.4848 0.820827C18.4993 0.805242 18.5189 0.796362 18.5395 0.796078H19.4293C19.4498 0.796375 19.4695 0.805261 19.484 0.820845C19.4985 0.836429 19.5068 0.85748 19.5071 0.879517V3.80018C19.5068 3.82223 19.4985 3.84329 19.484 3.85888C19.4695 3.87448 19.4498 3.88337 19.4293 3.88367H18.5395C18.5189 3.88337 18.4993 3.87448 18.4848 3.85889C18.4702 3.84329 18.4619 3.82223 18.4617 3.80018V0.879517ZM14.7195 0.879517C14.7198 0.857472 14.7281 0.836413 14.7426 0.820827C14.7571 0.805242 14.7768 0.796362 14.7973 0.796078H15.6871C15.7076 0.796362 15.7272 0.805242 15.7418 0.820827C15.7563 0.836413 15.7646 0.857472 15.7649 0.879517V3.80018C15.7649 3.84541 15.7292 3.88367 15.6871 3.88367H14.7973C14.7767 3.88337 14.7571 3.87448 14.7426 3.85889C14.7281 3.84329 14.7198 3.82223 14.7195 3.80018V0.879517ZM10.9773 0.879517C10.9776 0.857472 10.9859 0.836413 11.0004 0.820827C11.0149 0.805242 11.0346 0.796362 11.0551 0.796078H11.9449C11.9654 0.796362 11.9851 0.805242 11.9996 0.820827C12.0141 0.836413 12.0224 0.857472 12.0227 0.879517V3.80018C12.0227 3.84541 11.987 3.88367 11.9449 3.88367H11.0551C11.0346 3.88337 11.0149 3.87448 11.0004 3.85889C10.9859 3.84329 10.9776 3.82223 10.9773 3.80018V0.879517ZM7.23508 0.879517C7.23535 0.85748 7.24363 0.836429 7.25816 0.820845C7.27268 0.805261 7.2923 0.796375 7.31284 0.796078H8.20265C8.2232 0.796362 8.24283 0.805242 8.25737 0.820827C8.2719 0.836413 8.28019 0.857472 8.28046 0.879517V3.80018C8.28046 3.84541 8.2448 3.88367 8.20265 3.88367H7.31284C7.29229 3.88337 7.27267 3.87448 7.25814 3.85888C7.24362 3.84329 7.23534 3.82223 7.23508 3.80018V0.879517ZM3.49289 0.879517C3.49317 0.857472 3.50146 0.836413 3.51599 0.820827C3.53053 0.805242 3.55016 0.796362 3.5707 0.796078H4.46047C4.48101 0.796375 4.50063 0.805261 4.51515 0.820845C4.52968 0.836429 4.53796 0.85748 4.53823 0.879517V3.80018C4.53797 3.82223 4.52969 3.84329 4.51517 3.85888C4.50064 3.87448 4.48102 3.88337 4.46047 3.88367H3.5707C3.55015 3.88337 3.53052 3.87448 3.51599 3.85889C3.50146 3.84329 3.49317 3.82223 3.49289 3.80018V0.879517ZM2.16599 2.92171H2.75096V3.80018C2.75096 4.28514 3.11873 4.67975 3.5707 4.67975H4.46047C4.91245 4.67975 5.28017 4.28514 5.28017 3.80018V2.92171H6.49314V3.80018C6.49314 4.28514 6.86086 4.67975 7.31284 4.67975H8.20265C8.65463 4.67975 9.0224 4.28514 9.0224 3.80018V2.92171H10.2353V3.80018C10.2353 4.28514 10.6031 4.67975 11.0551 4.67975H11.9448C12.3968 4.67975 12.7646 4.28514 12.7646 3.80018V2.92171H13.9775V3.80018C13.9775 4.28514 14.3453 4.67975 14.7973 4.67975H15.687C16.139 4.67975 16.5068 4.28514 16.5068 3.80018V2.92171H17.7197V3.80018C17.7197 4.28514 18.0875 4.67975 18.5394 4.67975H19.4293C19.8812 4.67975 20.2489 4.28514 20.2489 3.80018V2.92171H20.834C21.6192 2.92171 22.258 3.60713 22.258 4.44963V6.32887H0.741935V4.44963C0.741935 3.60713 1.38074 2.92171 2.16599 2.92171ZM2.16599 22.2039C1.38074 22.2039 0.741935 21.5185 0.741935 20.676V7.1249H22.2581V17.7597C22.2581 17.9007 22.2428 18.0336 22.2126 18.1594H19.3083C18.8563 18.1594 18.4886 18.554 18.4886 19.039V22.1551C18.3713 22.1875 18.2474 22.2039 18.116 22.2039H2.16599ZM19.2305 21.6409V19.0389C19.2308 19.0169 19.239 18.9958 19.2536 18.9802C19.2681 18.9646 19.2877 18.9557 19.3083 18.9554H21.7334L19.2305 21.6409Z"></path>
                                        </svg>
                                    </div>
                                    <div class="counter-content">
                                        <p>Total Bookings In Platform</p>
                                        <div class="number">
                                            <h3 class="counter">
                                                {bookings.length}
                                            </h3>
                                            <span>+</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Display custom message */}
                    <div className="mt-2">
                        <h4>
                            Dữ liệu trong tháng {selectedMonth + 1}/
                            {selectedYear}
                        </h4>
                    </div>
                    <div
                        className="tab-pane fade show active"
                        id="hotel"
                        role="tabpanel"
                        aria-labelledby="hotel-tab"
                    >
                        <div className="recent-listing-area">
                            <div className="tab-content" id="myTab2Content">
                                <div
                                    className="tab-pane fade show active"
                                    id="all2"
                                    role="tabpanel"
                                    aria-labelledby="all2-tab"
                                >
                                    <div className="recent-listing-table">
                                        <table className="eg-table2">
                                            <thead>
                                                <tr>
                                                    <th>STT</th>
                                                    <th>Mã đặt phòng</th>
                                                    <th>Liên hệ</th>
                                                    <th>Tổng tiền</th>
                                                    <th>Thanh toán</th>
                                                    <th>Tình trạng</th>
                                                    <th>Thời gian</th>
                                                    <th>#</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {filteredBookings &&
                                                filteredBookings.length > 0 ? (
                                                    currentItems.map(
                                                        (booking, index) => {
                                                            const globalIndex =
                                                                (currentPage -
                                                                    1) *
                                                                    itemsPerPage +
                                                                index;
                                                            return (
                                                                <tr key={index}>
                                                                    <td
                                                                        data-label="index"
                                                                        style={{
                                                                            width: "5%",
                                                                        }}
                                                                    >
                                                                        <div className="d-flex flex-column">
                                                                            <span className="mb-1">
                                                                                {globalIndex +
                                                                                    1}
                                                                            </span>
                                                                        </div>
                                                                    </td>
                                                                    <td
                                                                        data-label="Tour Package"
                                                                        style={{
                                                                            width: "25%",
                                                                        }}
                                                                    >
                                                                        <div className="product-name">
                                                                            <div className="product-content">
                                                                                <p className="mb-1">
                                                                                    <span>
                                                                                        Mã:{" "}
                                                                                        {
                                                                                            booking.id
                                                                                        }
                                                                                    </span>
                                                                                </p>
                                                                                <span>
                                                                                    Khách:{" "}
                                                                                    <strong>
                                                                                        {
                                                                                            booking.bookingName
                                                                                        }
                                                                                    </strong>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                    </td>

                                                                    <td data-label="Contact">
                                                                        <div className="d-flex flex-column">
                                                                            <span className="mb-1">
                                                                                {
                                                                                    booking.bookingPhone
                                                                                }
                                                                            </span>
                                                                            <span>
                                                                                {
                                                                                    booking.bookingEmail
                                                                                }
                                                                            </span>
                                                                        </div>
                                                                    </td>
                                                                    <td data-label="Price">
                                                                        {convertToVND(
                                                                            booking.totalPrice
                                                                        )}
                                                                    </td>
                                                                    <td
                                                                        className="text-primary"
                                                                        data-label="Payment"
                                                                    >
                                                                        {
                                                                            booking.paymentType
                                                                        }{" "}
                                                                    </td>
                                                                    <td data-label="Status">
                                                                        <span class="confirmed">
                                                                            {" "}
                                                                            {
                                                                                booking.status
                                                                            }
                                                                        </span>
                                                                    </td>
                                                                    <td data-label="Execution Time">
                                                                        {moment(
                                                                            booking.checkinDate
                                                                        ).format(
                                                                            "DD/MM/YYYY"
                                                                        )}{" "}
                                                                        -{" "}
                                                                        {moment(
                                                                            booking.checkoutDate
                                                                        ).format(
                                                                            "DD/MM/YYYY"
                                                                        )}
                                                                    </td>
                                                                    <td data-label="Review">
                                                                        {booking.reviewed ===
                                                                        false ? (
                                                                            <strong className="text-primary">
                                                                                Chưa
                                                                                đánh
                                                                                giá
                                                                            </strong>
                                                                        ) : (
                                                                            <strong className="text-warning">
                                                                                Đã
                                                                                đánh
                                                                                giá
                                                                            </strong>
                                                                        )}
                                                                    </td>
                                                                </tr>
                                                            );
                                                        }
                                                    )
                                                ) : (
                                                    <tr>
                                                        <td
                                                            colSpan="12"
                                                            className="h-64"
                                                        >
                                                            <div className="h-full flex-col align-items-center justify-content-center text-center">
                                                                <strong
                                                                    className="text-secondary  mb-2"
                                                                    style={{
                                                                        fontSize:
                                                                            "1.1rem",
                                                                    }}
                                                                >
                                                                    Chưa có lịch
                                                                    sử đặt phòng
                                                                </strong>
                                                                <p
                                                                    className=""
                                                                    style={{
                                                                        fontSize:
                                                                            "0.9rem",
                                                                    }}
                                                                >
                                                                    Các đơn đặt
                                                                    phòng của
                                                                    bạn sẽ xuất
                                                                    hiện tại đây
                                                                </p>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                )}
                                            </tbody>
                                        </table>
                                        {filteredBookings &&
                                            filteredBookings.length > 0 && (
                                                <div className="pagination-area">
                                                    <ul className="paginations">
                                                        {pageNumbers.map(
                                                            (number) => (
                                                                <li
                                                                    key={number}
                                                                    className={`page-item ${
                                                                        currentPage ===
                                                                        number
                                                                            ? "active"
                                                                            : ""
                                                                    }`}
                                                                >
                                                                    <a
                                                                        style={{
                                                                            cursor: "pointer",
                                                                        }}
                                                                        onClick={() =>
                                                                            handlePageClick(
                                                                                number
                                                                            )
                                                                        }
                                                                    >
                                                                        {number}
                                                                    </a>
                                                                </li>
                                                            )
                                                        )}
                                                    </ul>
                                                    <ul className="paginations-buttons">
                                                        <li>
                                                            <a
                                                                onClick={
                                                                    handlePrevClick
                                                                }
                                                                className={
                                                                    currentPage ===
                                                                    1
                                                                        ? "disabled"
                                                                        : ""
                                                                }
                                                                style={{
                                                                    cursor: "pointer",
                                                                }}
                                                            >
                                                                <svg
                                                                    xmlns="http://www.w3.org/2000/svg"
                                                                    width="7"
                                                                    height="14"
                                                                    viewBox="0 0 7 14"
                                                                >
                                                                    <path d="M0 7.00008L7 0L2.54545 7.00008L7 14L0 7.00008Z"></path>
                                                                </svg>
                                                                Prev
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a
                                                                onClick={
                                                                    handleNextClick
                                                                }
                                                                className={
                                                                    currentPage ===
                                                                    totalPages
                                                                        ? "disabled"
                                                                        : ""
                                                                }
                                                                style={{
                                                                    cursor: "pointer",
                                                                }}
                                                            >
                                                                Next
                                                                <svg
                                                                    xmlns="http://www.w3.org/2000/svg"
                                                                    width="7"
                                                                    height="14"
                                                                    viewBox="0 0 7 14"
                                                                    fill="none"
                                                                >
                                                                    <path d="M7 7.00008L0 0L4.45455 7.00008L0 14L7 7.00008Z"></path>
                                                                </svg>
                                                            </a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            )}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </>
    );
}

export default HotelOwnerDashBoard;
